openapi: 3.0.2
info:
  title: PII Server API
  description: >
    This Spec describes the APIs that are exposed by ai pii service that can work with AI Sanitizer Plugin to santize PII entities in the requests
  version: 1.0.0

paths:
  /llm/v1/sanitize:
    post:
      summary: sanitize the PII entities in the request body
      description: Returns the sanitized results.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: ['text', 'anonymize', 'options']
              properties:
                text:
                  type: string
                anonymize:
                  type: array
                  items:
                    $ref: '#/components/schemas/PIIEntity'
                options:
                  type: object
                  properties:
                    redact_type:
                      type: string
                      enum: ['synthetic', 'placeholder']
                custom_patterns:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                      regex:
                        type: string
                      score:
                        type: number

      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  text:
                    type: string
                  identified_pii:
                    type: array
                    items:
                      $ref: '#/components/schemas/PIIEntity'
                  anonymized_pii:
                    type: array
                    items:
                      $ref: '#/components/schemas/PIIEntity'
                  detected_languages:
                    type: array
                    items:
                      type: string
                  duration:
                    type: number
        '400':
          description: when error happens
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  /llm/v1/status:
    get:
      summary: Health check
      description: Returns the health status of the service.
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok


components:
  schemas:
    PIIEntity:
      enum:
        - general
        - phone
        - creditcard
        - crypto
        - date
        - ip
        - nrp
        - ssn
        - url
        - medical
        - driverlicense
        - passport
        - bank
        - nationalid
        - custom
        - credentials
        - all
        - all_and_credentials
