---
title: Dev Portal API packaging
content_type: reference
layout: reference

products:
    - dev-portal

breadcrumbs: 
  - /dev-portal/
tags:
  - api-catalog
  - api-composition

works_on:
    - konnect
api_specs:
  - konnect/api-builder
search_aliases:
  - publish API specs
  - API catalog
  - API composition
  - API packaging
  - API bundle
description: | 
    Learn how to package APIs in Dev Portal and what API packages are.
related_resources:
  - text: Dev Portal APIs
    url: /dev-portal/apis/
  - text: Automate your API catalog with Dev Portal
    url: /how-to/automate-api-catalog/
  - text: Automate your API catalog with Terraform
    url: /how-to/automate-api-catalog-with-terraform/
  - text: Application authentication strategies
    url: /dev-portal/auth-strategies/
---

<!--{:.success}
> This is a reference guide, you can also follow along with our [Package APIs for partners with Dev Portal](/how-to/package-apis-for-partners-with-dev-portal/) tutorial.-->

You can compose different API packages from your APIs in Dev Portal. API packages allow you to:
* Flexibly add various operations and endpoints from your API to different packages depending on how you want to make those operations available in your Dev Portals
* Apply different rate limits on a per operation and per package basis
* Manage access control on a per package basis

The following table describes common API package use cases:
<!--vale off-->
{% table %}
columns:
  - title: Use case
    key: use-case
  - title: Description
    key: description
  - title: Example
    key: example
rows:
  - use-case: Customize APIs for partners
    description: Using API packages, you can customize which operations/endpoints are included in Dev Portals for partners.
    example: If you have an API with two different endpoints, one for `/billing` and one for `/flights`, you can add just the `/flights` endpoint to an API package for partners and keep the `/billing` and `/flights` endpoints in a package that only the rest of your company can view.
  - use-case: Manage APIs in development and production
    description: As APIs move from development to a production environment, you can add them to the production API package so that users can view them in your Dev Portal.
    example: Your API's `/billing` and `/flights` endpoints are both in development and included in the API package that is published to your internal Dev Portal. The `/flights` endpoint is released to production, so you can now create an API package that contains the `/flights` endpoint to release to your public, production Dev Portal.
{% endtable %}
<!--vale on-->

## How API packages work

API packages are composed from operations. Operations allow you to compose REST-style APIs from a combination of the hostname, path, and method that are processed by the data plane. They are independent of Route definitions. If an OpenAPI spec is added to the API, the operations are autogenerated. 

The following diagram shows an example of how API packages can be composed from operations:

<!--vale off-->
{% mermaid %}
flowchart LR
 subgraph subGraph0["Control plane"]
        1["Billing Gateway Service"]
        2["Flights Gateway Service"]
  end
 subgraph subGraph1["Partners API package"]
        3["POST /flights"]
        4["GET /flights"]
  end
 subgraph subGraph2["Org API package"]
        5["POST /billing"]
        6["GET /billing"]
        7["POST /flights"]
        8["GET /flights"]
  end
    1 --> 5 & 6
    2 --> 7 & 8 & 3 & 4
    style subGraph2 fill:#C8E6C9
    style subGraph1 fill:#BBDEFB
{% endmermaid %}
<!--vale on-->

Packaging APIs involves the following steps:
1. Create an API and attach an OpenAPI spec.
1. Link a control plane (or control planes) for to allow developer consumption. 
1. Apply the Access Control Enforcement (ACE) plugin globally.
1. Create an API package by adding operations and package rate limits. Operations are automatically mapped to Routes using your API's OpenAPI spec or you can create them manually.

### ACE plugin

Previously, when you created an API catalog in Dev Portal and linked the APIs to a Gateway Service, {{site.konnect_short_name}} would automatically apply the {{site.konnect_short_name}} application auth (KAA) plugin automatically. 

API packages uses the ACE plugin instead to manage developer access control to APIs. Unlike the KAA plugin, the ACE plugin can link to control planes to configure access control and create operations for Gateway Services in those control planes. 

### Package rate limits

You can set individual rate limits on an API package as well as operations in that package. Keep the following in mind when configuring rate limits:
* API package rate limits apply across all operations in the API package **cumulatively**, not individually.
* Each Operation in an API Package can additionally have an individual rate limit defined. This rate limit applies simultaneously with the rate limiting being counted at the API Package level.
* ??? What happens when the Gateway Service or Route has rate limits applied? how do the two interact?

For example, if you have the following rate limits set:
* **API package A**: 10 requests per second
* **Operation 1**: 5 requests per second

A request that is authorized for Operation 1 will count toward both the rate limit for both the API Package A and Operation 1. So, if one request is sent, the authorized application will have nine requests remaining for API Package A and four requests remaining for Operation 1 for the configured time period (per second).

### API package limitations

When configuring API packages, keep the following limitations in mind:

* If you have two endpoints in your spec, one with a trailing slash one without, both are counted as the same operation.
* If two operations have the same path and method, they are marked as the same operation.
* All operations for a control plane are removed when you unlink the control plane.
* Control planes can only be mapped to one API at a time.
* You can't change a version or edit a spec for an API if it would remove an operation. The recommended method to remove an operation is to unlink the control plane from the API.

## Package APIs with Dev Portal

This guide shows you how to create an API package in the {{site.konnect_short_name}} UI.

### Prerequisites

To package APIs with Dev Portal, you need:
* A v3 Dev Portal created in {{site.konnect_short_name}}
* A [Gateway Service](/gateway/entities/service/#set-up-a-gateway-service) and [Route](/gateway/entities/route/#set-up-a-route) added to your control plane
* The following roles:
  * Editor role for APIs
  * Publisher role for the API and API package
* [An API created](/dev-portal/apis/) with an [OpenAPI spec](/dev-portal/apis/#api-specs) associated with it

### Associate a control plane

1. In {{site.konnect_short_name}}, navigate to **Dev Portal** > **APIs** in the sidebar.
1. Click your API.
1. Click the **Gateway** tab.
1. Click **Link gateway**.
1. Select a control plane from the **Control plane** dropdown menu.
1. Select **Link to a control plane**.
1. In the Add the Access Control and Enforcement plugin settings, click **Add plugin**.
1. Click **Link gateway**.

Your operations should now be autogenerated based on how your OpenAPI spec maps to your Routes.

### Assign operations to API packages

1. In {{site.konnect_short_name}}, navigate to **Dev Portal** > **APIs** in the sidebar.
1. Click the **API packages** tab.
1. Click **Create API package**.
1. Enter a name in the **API package name** field.
1. Enable the Package rate limit and configure your rate limit.
1. Click **Add operations from APIs** in the API operations settings.
1. In the Add API operations pane, click your API and click **Add** next to the operations you want to package.
1. Click **Create API package**. 

### Publish packages to Dev Portal

1. In {{site.konnect_short_name}}, navigate to **Dev Portal** > **APIs** in the sidebar.
1. Click the **API packages** tab.
1. Click your API package.
1. Click **Publish API**.
1. Select your Dev Portal from the **Portal** dropdown menu.
1. Select an auth strategy from the **Authentication strategy** dropdown menu.
1. Click **Publish API**. 

Your API package will now be published to your Dev Portal.
