---
title: Dump server
description: 'Use the dump config server to inspect and debug Kong configurations generated by the Gateway Operator for each control plane.'
content_type: reference
layout: reference
permalink: /operator/control-planes/config-dump-server/
breadcrumbs:
  - /operator/
  - index: operator
    group: ControlPlane Management
products:
  - operator

tools:
  - operator

works_on:
  - konnect
  - on-prem

related_resources:
  - text: "CLI arguments reference"
    url: /operator/reference/custom-resources/
  - text: "Troubleshooting control plane status"
    url: /operator/dataplanes/troubleshooting/status/
  - text: "{{ site.operator_product_name }} Helm Chart"
    url: https://github.com/Kong/charts/tree/main/charts/kong-operator

min_version:
  operator: '1.6'
faqs:
  - q: How can I inspect the Kong configuration generated for my control plane?
    a: |
        Enable the dump config server when installing {{ site.operator_product_name }}, then use the
        diagnostic endpoints to inspect configurations for debugging and troubleshooting.
---

The dump config server is a diagnostic feature in {{ site.operator_product_name }} that allows you to inspect the Kong configuration generated for each ControlPlane. This is particularly useful when debugging configuration issues or understanding how your Kubernetes resources are translated to Kong configuration.

## Enable the dump config server

The dump config server is disabled by default. You must enable it when installing or upgrading {{ site.operator_product_name }}.

Enable the dump config server by setting the values during installation:
{% navtabs "install" %}
{% navtab "CLI" %}
   ```bash
   helm upgrade --install kong-operator kong/kong-operator \
     --set enableControlplaneConfigDump=true \
     --set controlplaneConfigDumpPort=10256 \
     --namespace kong-system \
     --create-namespace
   ```
{% endnavtab %}
{% navtab "Values file" %}

Create a values file:

```yaml
# operator-values.yaml
enableControlplaneConfigDump: true
controlplaneConfigDumpPort: 10256  # Optional: defaults to 10256
```

Then install with:

```bash
helm upgrade --install kong-operator kong/kong-operator \
    -f operator-values.yaml \
    --namespace kong-system \
    --create-namespace
```
{% endnavtab %}
{% endnavtabs %}

Verify the dump config service is created:

```bash
kubectl get service -n kong-system kong-operator-controlplane-config-dump
```

The output should show:
```
NAME                                     TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)     AGE
kong-operator-controlplane-config-dump   ClusterIP   10.96.100.150   <none>        10256/TCP   1m
```

## Access the dump config server

The dump config server is not exposed externally by default. Use port-forwarding to access it locally:

```bash
kubectl port-forward -n kong-system service/kong-operator-controlplane-config-dump 10256:10256
```

Keep this terminal open while you work with the dump config server.

## List managed control planes

To see all control planes managed by the operator:

```bash
curl http://localhost:10256/debug/controlplanes | jq .
```

Example response:
```json
{
  "controlPlanes": [
    {
      "namespace": "default",
      "name": "my-controlplane",
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
    },
    {
      "namespace": "production",
      "name": "prod-cp",
      "id": "b2c3d4e5-f6a7-8901-bcde-f23456789012"
    }
  ]
}
```

### Filter by namespace

To list control planes in a specific namespace:

```bash
curl http://localhost:10256/debug/controlplanes/namespace/production | jq .
```

## Dump ControlPlane configuration

To inspect the Kong configuration for a specific ControlPlane:

```bash
# Replace with your ControlPlane's namespace and name
curl http://localhost:10256/debug/controlplanes/namespace/default/name/my-controlplane/config/successful
```

This returns the raw Kong configuration that would be sent to the Kong Admin API.

### Pretty-print the configuration

For better readability, pipe the output through `jq`:

```bash
curl -s http://localhost:10256/debug/controlplanes/namespace/default/name/my-controlplane/config/successful | jq .
```

### Save configuration to a file

To save the configuration for later analysis:

```bash
curl -s http://localhost:10256/debug/controlplanes/namespace/default/name/my-controlplane/config/successful \
  > controlplane-config-$(date +%Y%m%d-%H%M%S).json
```

## Examples

### Debug routing issues

When debugging why a route isn't working as expected:

1. First, create a test control plane and route:

   ```yaml
   echo '
   apiVersion: gateway-operator.konghq.com/v1beta1
   kind: ControlPlane
   metadata:
     name: test-cp
     namespace: default
   spec:
     dataplane: test-dataplane
     gatewayClass: kong
   ---
   apiVersion: gateway.networking.k8s.io/v1
   kind: HTTPRoute
   metadata:
     name: test-route
     namespace: default
   spec:
     parentRefs:
     - name: kong
       namespace: default
     rules:
     - matches:
       - path:
           type: PathPrefix
           value: /test
       backendRefs:
       - name: test-service
         port: 80
   ' | kubectl apply -f -
   ```

2. Wait for the control plane to be ready:

   ```bash
   kubectl wait --for=condition=Ready controlplane/test-cp -n default --timeout=120s
   ```

3. Dump and inspect the configuration:

   ```bash
   curl -s http://localhost:10256/debug/controlplanes/namespace/default/name/test-cp/config/successful | \
     jq '.routes[] | select(.paths[] | contains("/test"))'
   ```

This shows you exactly how your HTTPRoute was translated to Kong configuration.

### Monitor configuration changes

Create a script to monitor configuration size over time:

```bash
#!/bin/bash
# monitor-config-size.sh

NAMESPACE="default"
NAME="my-controlplane"
INTERVAL=60  # seconds

echo "Monitoring ControlPlane $NAMESPACE/$NAME configuration size..."
echo "Timestamp,Size(bytes)"

while true; do
    SIZE=$(curl -s "http://localhost:10256/debug/controlplanes/namespace/$NAMESPACE/name/$NAME/config/successful" | wc -c)
    TIMESTAMP=$(date +"%Y-%m-%d %H:%M:%S")
    echo "$TIMESTAMP,$SIZE"
    sleep $INTERVAL
done
```

### Compare configurations

To compare configurations between twocontrol planes:

```bash
# Dump both configurations
curl -s http://localhost:10256/debug/controlplanes/namespace/default/name/cp1/config/successful > cp1.json
curl -s http://localhost:10256/debug/controlplanes/namespace/default/name/cp2/config/successful > cp2.json

# Compare them (requires jq and diff)
diff <(jq -S . cp1.json) <(jq -S . cp2.json)
```

## Troubleshooting

### Control plane not found

If you get a "ControlPlane not found" error:

1. Verify the ControlPlane exists:
   ```bash
   kubectl get controlplanes -A
   ```

2. Check that it's managed by the operator:
   ```bash
   kubectl logs -n kong-system deployment/kong-operator-controller-manager | grep "your-controlplane-name"
   ```

3. Ensure you're using the correct namespace and name in the URL.

### Config dump not enabled for control plane

If you see "control plane does not enable config dump":

This means the control plane exists but doesn't have config dumping enabled at the individual control plane level. This is a per-control plane setting that may need to be configured separately from the global operator setting.

### Empty or minimal configuration

If the configuration appears empty or minimal:

1. Check the control plane status:
   ```bash
   kubectl get controlplane -n default my-controlplane -o jsonpath='{.status.conditions}' | jq .
   ```

2. Verify there are routes or services configured for this control plane.

3. Check operator logs for any errors:
   ```bash
   kubectl logs -n kong-system deployment/kong-operator-controller-manager --tail=50
   ```

## Security considerations

{:.warning}
> The dump config server exposes potentially sensitive configuration data, including service endpoints and routing rules. 
> Always use proper network policies and RBAC to restrict access to the dump config service in production environments.

Consider these security practices:

1. **Use NetworkPolicies** to restrict which pods can access the dump config service
2. **Implement RBAC** to control who can port-forward to the service
3. **Avoid exposing the service** externally through LoadBalancer or Ingress
4. **Monitor access** to the dump config endpoints through audit logs

