---
title: Configure the OIDC plugin with Kong Identity
permalink: /how-to/configure-kong-identity-oidc/
content_type: how_to
breadcrumbs:
  - /kong-identity/

entities:
  - route
  - service
  - plugin
plugins:
  - openid-connect
products:
    - gateway
works_on:
  - konnect
tags:
    - authentication
description: Learn how to configure Kong Identity with OIDC.

tldr: 
  q: How do I configure Kong Identity with OIDC?
  a: | 
    Create a Kong Identity auth server, scope, claim, and client. Configure the OpenID Connect (OIDC) plugin with your issuer URL, audience, and `bearer` for the `auth_method`. Generate a client token by sending a POST request to `$ISSUER_URL/oauth/token` and use the access token in a header when you send a request to a protected  Gateway Service.

tools:
    # - konnect-api
    - deck
  
prereqs:
  entities:
    services:
      - example-service
    routes:
      - example-route

faqs:
  - q: How do I use Kong Identity with Consumer-scoped plugins and OIDC auth?
    a: |
      For Consumer-scoped plugins, do the following:
      - Create a Consumer per client in the respective control plane.
      - The OIDC plugin will map clients to Consumers using claims with the `consumer_claim` field.
      - Apply the Consumer-scoped plugin to the Consumer entity in the control plane.
      You don't need to migrate the client credential to a Consumer credential.
  - q: Can I retrieve my clientâ€™s secret again?
    a: |
      No, the secret is only shared once when the client is created. Store it securely.
automated_tests: false
related_resources:
  - text: "Kong Identity"
    url: /kong-identity/
  - text: Dynamic claim templating
    url: /kong-identity/#dynamic-claim-templates
  - text: Configure the OAuth 2.0 Introspection plugin with Kong Identity
    url: /how-to/configure-kong-identity-oauth-introspection/
  - text: Configure the Upstream OAuth plugin with Kong Identity
    url: /how-to/configure-kong-identity-upstream-oauth/
---

{% include /how-tos/steps/konnect-identity-server-scope-claim-client.md %}

## Configure the OIDC plugin

You can configure the [OIDC plugin](/plugins/openid-connect/) to use Kong Identity as the identity provider for your Gateway Services. In this example, you'll apply the plugin to the control plane globally, but you can alternatively apply it to the Gateway Service.

First, get the ID of the `quickstart` control plane you configured in the prerequisites:

<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes?filter%5Bname%5D%5Bcontains%5D=quickstart
status_code: 201
method: GET
{% endkonnect_api_request %}
<!--vale on-->

Export the control plane ID:
```sh
export CONTROL_PLANE_ID='YOUR-CONTROL-PLANE-ID'
```

Enable the OIDC plugin globally:
<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes/$CONTROL_PLANE_ID/core-entities/plugins/
status_code: 201
method: POST
headers:
  - 'Content-Type: application/json'
body:
  name: openid-connect
  config:
    issuer: $ISSUER_URL
    auth_methods:
    - bearer
    audience:
    - http://myhttpbin.dev
{% endkonnect_api_request %}
<!--vale on-->

In this example:
* `issuer`: Setting that connects the plugin to your IdP (in this case, Kong Identity). 
* `auth_methods`: Specifies that the plugin should use bearer for authentication.

{% include /how-tos/steps/konnect-identity-generate-token.md %}

## Access the Gateway service using the token 
Access the `example-service` Gateway Service using the short-lived token generated by the authorization server from Kong Identity:

{% validation request-check %}
url: /anything
method: GET
status_code: 200
display_headers: true
headers:
  - "Authorization: Bearer $ACCESS_TOKEN"
{% endvalidation %}
