---
title: Configure the OAuth 2.0 Introspection plugin with Kong Identity
permalink: /how-to/configure-kong-identity-oauth-introspection/
content_type: how_to
breadcrumbs:
  - /kong-identity/

entities:
  - route
  - service
  - plugin
plugins:
  - oauth2-introspection
products:
    - gateway
works_on:
  - konnect
tags:
    - authentication
description: Learn how to configure Kong Identity with OAuth 2.0 Introspection.

tldr: 
  q: How do I configure Kong Identity with OAuth 2.0 Introspection?
  a: | 
    Create a Kong Identity auth server, scope, claim, and client. Use the Base64-encoded client ID and client secret for `config.authorization_value` in the OAuth 2.0 Introspection plugin configuration as well as your auth server introspection endpoint. Generate a client token by sending a POST request to `$ISSUER_URL/oauth/token` and use the access token in a header when you send a request to a protected Gateway Service.

tools:
    # - konnect-api
    - deck
  
prereqs:
  entities:
    services:
      - example-service
    routes:
      - example-route
faqs:
  - q: Can I retrieve my clientâ€™s secret again?
    a: |
      No, the secret is only shared once when the client is created. Store it securely.

automated_tests: false
related_resources:
  - text: "Kong Identity"
    url: /kong-identity/
  - text: Dynamic claim templating
    url: /kong-identity/#dynamic-claim-templates
  - text: Configure the OIDC plugin with Kong Identity
    url: /how-to/configure-kong-identity-oidc/
  - text: Configure the Upstream OAuth plugin with Kong Identity
    url: /how-to/configure-kong-identity-upstream-oauth/
---

{% include /how-tos/steps/konnect-identity-server-scope-claim-client.md %}

## Encode your client credentials

When you configure the OAuth 2.0 Introspection plugin with Kong Identity, you must pass the `client_id` and `client_secret` as a Base64-encoded Basic Auth string (`Basic MG9hNWl...`) in the `config.authorization_value` field.

Base64-encode your client ID and client secret:
```sh
echo -n "$CLIENT_ID:$CLIENT_SECRET" | base64
```

Export your encoded credentials:
```sh
export ENCODED_CREDENTIALS='YOUR-ENCODED-CREDENTIALS'
```

## Configure the OAuth 2.0 Introspection plugin

You can configure the [OAuth 2.0 Introspection plugin](/plugins/oauth2-introspection/) to use Kong Identity as the identity provider for your Gateway Services. In this example, you'll apply the plugin to the control plane globally, but you can alternatively apply it to a Gateway Service.

First, get the ID of the `quickstart` control plane you configured in the [prerequisites](#kong-konnect):

<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes?filter%5Bname%5D%5Bcontains%5D=quickstart
status_code: 201
method: GET
{% endkonnect_api_request %}
<!--vale on-->

Export the control plane ID:
```sh
export CONTROL_PLANE_ID='YOUR-CONTROL-PLANE-ID'
```

Enable the OAuth 2.0 Introspection plugin globally:
<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes/$CONTROL_PLANE_ID/core-entities/plugins/
status_code: 201
method: POST
headers:
  - 'Content-Type: application/json'
body:
  name: oauth2-introspection
  config:
    introspection_url: $ISSUER_URL/introspect
    authorization_value: Basic $ENCODED_CREDENTIALS
    consumer_by: client_id
    custom_claims_forward: 
    - Claim
{% endkonnect_api_request %}
<!--vale on-->

{% include /how-tos/steps/konnect-identity-generate-token.md %}

## Access the Gateway Service using the token 
Access the `example-service` Gateway Service using the short-lived token generated by the authorization server from Kong Identity:

{% validation request-check %}
url: /anything
method: GET
status_code: 200
display_headers: true
headers:
  - "Authorization: Bearer $ACCESS_TOKEN"
{% endvalidation %}

