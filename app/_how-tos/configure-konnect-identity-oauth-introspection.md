---
title: Configure the OAuth 2.0 Introspection plugin with {{site.konnect_short_name}} Identity
content_type: how_to
breadcrumbs:
  - /konnect-identity/

tech_preview: true
entities:
  - route
  - service
  - plugin
plugins:
  - oauth2-introspection
products:
    - gateway
works_on:
  - konnect
tags:
    - authentication
description: Learn how to configure {{site.konnect_short_name}} Identity with OAuth 2.0 Introspection.

tldr: 
  q: How do I configure {{site.konnect_short_name}} Identity with OAuth 2.0 Introspection?
  a: | 
    Create a {{site.konnect_short_name}} Identity auth server, scope, claim, and client. Use the Base64-encoded client ID and client secret for `config.authorization_value` in the OAuth 2.0 Introspection plugin configuration as well as your auth server introspection endpoint. Generate a client token by sending a GET request to `$ISSUER_URL/oauth/token` and use the access token in a header when you send a request to the Gateway Service.

tools:
    # - konnect-api
    - deck
  
prereqs:
  inline: 
    - title: "{{site.konnect_short_name}} Labs"
      content: |
        {{site.konnect_short_name}} Labs is a program for people to experiment with early-stage {{site.konnect_short_name}} experiences. {{site.konnect_short_name}} Identity can be opted in through {{site.konnect_short_name}} Labs. 
        You can view [Labs](https://cloud.konghq.com/global/labs/) in {{site.konnect_short_name}} 
      icon_url: /assets/icons/world.svg
  entities:
    services:
      - example-service
    routes:
      - example-route


automated_tests: false
related_resources:
  - text: "{{site.konnect_short_name}} Identity"
    url: /konnect-identity/
  - text: Dynamic claim templating
    url: /konnect-identity/#dynamic-claim-templates
  - text: Configure the OIDC plugin with {{site.konnect_short_name}} Identity
    url: /how-to/configure-konnect-identity-oidc/
  - text: Configure the Upstream OAuth plugin with {{site.konnect_short_name}} Identity
    url: /how-to/configure-konnect-identity-upstream-oauth/
---

{% include /how-tos/steps/konnect-identity-server-scope-claim-client.md %}

## Encode your client credentials

When you configure the OAuth 2.0 Introspection plugin with {{site.konnect_short_name}} Identity, you must pass the `client_id` and `client_secret` as a Base64-encoded Basic Auth string (`Basic MG9hNWl...`) in the `config.authorization_value` field.

Base64-encode your client ID and client secret:
```sh
echo -n "$CLIENT_ID:$CLIENT_SECRET" | base64
```

Export your encoded credentials:
```sh
export ENCODED_CREDENTIALS='YOUR-ENCODED-CREDENTIALS'
```

## Configure the OAuth 2.0 Introspection plugin

You can configure the [OAuth 2.0 Introspection plugin](/plugins/oauth2-introspection/) to use {{site.konnect_short_name}} Identity as the identity provider for your Gateway Services. In this example, you'll apply the plugin to the control plane globally, but you can alternatively apply it to the Gateway Service.

First, get the ID of the `quickstart` control plane you configured in the [prerequisites](#kong-konnect):

<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes?filter%5Bname%5D%5Bcontains%5D=quickstart
status_code: 201
method: GET
{% endkonnect_api_request %}
<!--vale on-->

Export the control plane ID:
```sh
export CONTROL_PLANE_ID='YOUR-CONTROL-PLANE-ID'
```

[Enable the OAuth 2.0 Introspection](/api/konnect/control-planes-config/v2/#/operations/create-plugin) plugin globally:
<!--vale off-->
{% konnect_api_request %}
url: /v2/control-planes/$CONTROL_PLANE_ID/core-entities/plugins/
status_code: 201
method: POST
headers:
  - 'Content-Type: application/json'
body:
  name: oauth2-introspection
  config:
    introspection_url: $ISSUER_URL/introspect
    authorization_value: Basic $ENCODED_CREDENTIALS
    consumer_by: client_id
    custom_claims_forward: 
    - Claim
{% endkonnect_api_request %}
<!--vale on-->

{% include /how-tos/steps/konnect-identity-generate-token.md %}

## Access the Gateway Service using the token 
Access the Gateway Service using the short-lived token generated by the authorization server from {{site.konnect_short_name}} Identity:

{% validation request-check %}
url: /anything
method: GET
status_code: 200
display_headers: true
headers:
  - "Authorization: Bearer $ACCESS_TOKEN"
{% endvalidation %}

