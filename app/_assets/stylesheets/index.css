@import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --removed-body-scroll-bar-size: 4px;

    --color-bg-primary: 247, 251, 255;
    --color-bg-secondary: 255, 255, 255;
    --color-bg-terciary: 7, 53, 103;
    --color-bg-code-block: 7, 53, 103;
    --color-bg-code-block-header: 28, 85, 146;
    --color-bg-hover-component: 235, 244, 254;

    --color-text-primary: 5, 47, 92;
    --color-text-secondary: 74, 96, 120;
    --color-text-terciary: 99, 119, 140;

    --color-border-primary: 5, 47, 92;
    --color-shadow-primary: 5, 47, 92, 0.04;

    --color-brand: 66, 140, 220;
    --color-brand-saturated: 24, 128, 240;

    --color-semantic-red-primary: 214, 67, 67;
    --color-semantic-red-secondary: 255, 229, 229;

    --color-semantic-yellow-primary: 220, 158, 66;
    --color-semantic-yellow-secondary: 255, 252, 224;

    --color-semantic-blue-primary: 33, 112, 197;
    --color-semantic-blue-secondary: 229, 247, 255;

    --color-semantic-green-primary: 66, 174, 148;
    --color-semantic-green-secondary: 224, 255, 249;

    --color-semantic-grey-primary: 84, 86, 88;
    --color-semantic-grey-secondary: 242, 242, 242;

    --color-semantic-purple-primary: 151, 71, 255;
    --color-semantic-purple-secondary: 240, 229, 255;

    --color-semantic-orange-primary: 226, 113, 64;
    --color-semantic-orange-secondary: 255, 238, 229;

    --color-semantic-teal-primary: 64, 199, 226;
    --color-semantic-teal-secondary: 224, 250, 255;

    --color-shadow-hover-card: 24, 128, 240, 0.16;

    --kui-border-width-20: 1px;

    --kui-color-text-neutral-stronger: rgb(var(--color-text-secondary));
    --kui-color-text-neutral-strong: rgb(var(--color-text-secondary));
    --kui-color-text-neutral: rgb(var(--color-text-primary));
    --kui-color-text: rgb(var(--color-text-primary));
    --kui-color-text-primary: rgb(var(--color-brand));
    --kui-color-text-primary-strong: rgb(var(--color-brand));
    --kui-color-text-primary-stronger: rgb(var(--color-brand));
    --kui-color-text-danger: rgb(var(--color-semantic-red-primary));
    --kui-color-background: rgb(var(--color-bg-secondary));
    --kui-color-background-neutral-weakest: rgb(var(--color-bg-primary));
    --kui-color-border: rgb(var(--color-border-primary), 0.05);
    --kui-color-border-primary: rgb(var(--color-brand));
    --kui-color-border-primary-strong: rgb(var(--color-brand));
    --kui-shadow-border: rgb(var(--color-brand-saturated), 0.4);
    --kui-shadow-border-primary: rgb(none, none, none);
    --kui-color-background-primary-weakest: rgb(var(--color-brand-saturated), 0.04);
    --kui-color-background-neutral-weaker: rgb(var(--color-bg-secondary));

    --kui-method-color-text-get: rgb(var(--color-semantic-blue-primary));
    --kui-method-color-background-get: rgb(var(--color-semantic-blue-secondary));
    --kui-method-color-text-post: rgb(var(--color-semantic-green-primary));
    --kui-method-color-background-post: rgb(var(--color-semantic-green-secondary));
    --kui-method-color-text-delete: rgb(var(--color-semantic-red-primary));
    --kui-method-color-background-delete: rgb(var(--color-semantic-red-secondary));
    --kui-method-color-text-patch: rgb(var(--color-semantic-teal-primary));
    --kui-method-color-background-patch: rgb(var(--color-semantic-teal-secondary));
    --kui-method-color-text-put: rgb(var(--color-semantic-yellow-primary));
    --kui-method-color-background-put: rgb(var(--color-semantic-yellow-secondary));

    --color-advanced-analytics-brand: var(--color-semantic-yellow-primary);
    --color-advanced-analytics-background: var(--color-semantic-yellow-secondary);
    --color-ai-gateway-brand: var(--color-semantic-green-primary);
    --color-ai-gateway-background: var(--color-semantic-green-secondary);
    --color-api-ops-brand: var(--color-semantic-teal-primary);
    --color-api-ops-background: var(--color-semantic-teal-secondary);
    --color-gateway-brand: var(--color-semantic-green-primary);
    --color-gateway-background: var(--color-semantic-green-secondary);
    --color-insomnia-brand: var(--color-semantic-purple-primary);
    --color-insomnia-background: var(--color-semantic-purple-secondary);
    --color-kic-brand: var(--color-brand);
    --color-kic-background: var(--color-semantic-blue-secondary);
    --color-mesh-brand: var(--color-semantic-orange-primary);
    --color-mesh-background: var(--color-semantic-orange-secondary);
    --color-service-catalog-brand: var(--color-semantic-red-primary);
    --color-service-catalog-background: var(--color-semantic-red-secondary);
    --color-dev-portal-brand: var(--color-semantic-teal-primary);
    --color-dev-portal-background: var(--color-semantic-teal-secondary);
    --color-org-management-brand: var(--color-semantic-grey-primary);
    --color-org-management-background: var(--color-semantic-grey-secondary);
    --color-kgo-brand: var(--color-semantic-blue-primary);
    --color-kgo-background: var(--color-semantic-blue-secondary);
    --color-api-products-brand: var(--color-semantic-orange-primary);
    --color-api-products-background: var(--color-semantic-orange-secondary);
  }

  .dark {
    --color-bg-primary: 2, 20, 40;
    --color-bg-secondary: 4, 40, 79;
    --color-bg-terciary: 28, 85, 146;
    --color-bg-code-block: 28, 85, 146;
    --color-bg-code-block-header: 7, 53, 103;
    --color-bg-hover-component: 7, 53, 103;

    --color-text-primary: 255, 255, 255;
    --color-text-secondary: 191, 202, 213;
    --color-text-terciary: 170, 185, 200;

    --color-border-primary: 255, 255, 255;
    --color-shadow-primary: 2, 20, 40, 0.08;

    --color-semantic-red-primary: 214, 67, 67;
    --color-semantic-red-secondary: 79, 28, 28;

    --color-semantic-yellow-primary: 255, 198, 115;
    --color-semantic-yellow-secondary: 64, 42, 10;

    --color-semantic-blue-primary: 66, 140, 220;
    --color-semantic-blue-secondary: 4, 40, 79;

    --color-semantic-green-primary: 134, 226, 204;
    --color-semantic-green-secondary: 18, 51, 43;

    --color-semantic-grey-primary: 192, 193, 195;
    --color-semantic-grey-secondary: 35, 36, 36;

    --color-semantic-purple-primary: 220, 193, 255;
    --color-semantic-purple-secondary: 65, 37, 102;

    --color-semantic-orange-primary: 226, 113, 64;
    --color-semantic-orange-secondary: 54, 36, 28;

    --color-semantic-teal-primary: 64, 199, 226;
    --color-semantic-teal-secondary: 16, 61, 70;

    --color-shadow-hover-card: 24, 128, 240, 0.4;
  }

  *::-webkit-scrollbar {
    @apply w-1 h-1;
  }

  *::-webkit-scrollbar-thumb {
    @apply bg-brand rounded-lg;
  }

  *::-webkit-scrollbar-track {
    @apply bg-code-block-header rounded-lg;
  }

  html {
    font-family: "Inter", system-ui, sans-serif;
    @apply text-secondary font-normal;
  }

  body {
    @apply transition-colors duration-200;
  }


  code {
    font-family: "JetBrains Mono", system-ui, sans-serif;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply text-primary;
  }

  h1 {
    @apply font-bold text-3xl tracking-[-.01em];
  }

  h2 {
    @apply font-bold text-xl tracking-[-.01em];
  }

  h3 {
    @apply font-bold text-lg tracking-[-.01em];
  }

  main h3:not(.card h3, .prerequisites h3, .cleanup h3, .landing-page h3) {
    @apply pt-4;
  }

  h4 {
    @apply font-bold text-base tracking-[-.01em];
  }

  main h4:not(.card h4) {
    @apply pt-3;
  }


  table {
    @apply bg-secondary shadow-primary border-none rounded-lg text-sm;

    &.table__sticky {
      @apply w-full;

      thead {
        @apply sticky top-0;
      }
    }
  }


  thead {
    @apply bg-secondary;
  }

  th {
    @apply bg-secondary text-primary font-semibold py-4 px-5 text-left;
  }

  th:first-child {
    @apply rounded-tl-lg;
  }

  th:last-child {
    @apply rounded-tr-lg;
  }

  th:not(:last-child) {
    @apply border-r border-primary/5;
  }

  td {
    @apply py-4 px-5;
  }

  td:not(:last-child) {
    @apply border-r border-primary/5;
  }

  tbody tr {
    @apply border-t border-primary/5;
  }

  details[open] summary .chevron-icon {
    @apply rotate-180;
  }

  ol, ul {
    @apply list-outside ml-4 flex flex-col gap-[0.4rem];
  }

  ol {
    @apply list-decimal;
  }

  ul {
    @apply list-disc;
  }

  li {
    @apply leading-[1.6rem];
  }

  li > *:not(:last-child) {
    @apply mb-2;
  }

  a {
    @apply hover:underline;
  }

  main a {
    @apply text-brand;
  }

  a code {
    @apply text-brand;
  }

  a[href^='http']:not([href^='#']):not([href^='https://insomnia.rest/run']):not(.no-icon)::after {
    @apply w-3 h-3 inline-block bg-contain bg-no-repeat align-middle bg-[url('/assets/icons/external-link.svg')] ml-1.5 content-[''];
  }

  code {
    @apply text-primary bg-secondary rounded border border-brand-saturated/40 text-sm;
  }

  code span {
    @apply text-white;
  }

  h3[id^="includes-kumahq-kuma-"][id$="-changelog"] {
    @apply flex items-center gap-1;

    > a {
      @apply w-auto;
    }
  }
}

@layer components {
  .button {
    @apply !py-2 !px-4 !rounded-md !text-sm !text-primary !font-semibold hover:!no-underline flex items-center gap-2 !border;
  }

  .button.button--primary {
    @apply !bg-brand !text-white !border-transparent;
  }

  .button.button--secondary {
    @apply !border-brand !text-primary;
  }

  .button.button--filters {
    @apply !border-brand !bg-secondary !border-brand-saturated/40 !text-terciary;
  }

  .highlight {
    @apply w-full bg-code-block h-fit;
  }

  div.highlight {
    @apply p-3 inline-grid rounded-lg;
  }

  pre {
    @apply overflow-auto whitespace-pre;
  }

  pre code {
    @apply whitespace-pre text-white bg-code-block border-none text-sm;
  }

  code.highlighter-rouge {
    @apply px-1;
  }

  .copy-code-snippet {
    @apply relative;
  }

  .copy-code-snippet div.highlight {
    @apply pr-10;
  }

  .copy-code-snippet .copy-action {
    @apply absolute cursor-pointer text-secondary right-3 top-3;
  }

  .copy-code-snippet .copy-action:hover {
    @apply opacity-20;
  }

  .copy-code-success-info {
    @apply absolute bg-primary border border-white px-1 py-2 rounded -mt-9 translate-x-1/3 transition-opacity duration-700 ease-out top-0 right-8 opacity-0;
  }

  #copy-code-input {
    @apply fixed -top-full;
  }

  [data-file] {
    @apply relative;
  }

  [data-file] div.highlight {
    @apply rounded-t-none;
  }

  [data-file]:before {
    @apply bg-code-block-header px-3 py-2 rounded-t-lg text-white w-full inline-block content-[attr(data-file)] text-sm;
  }

  .copy-code-snippet[data-file] .copy-action {
    @apply top-2;
  }

  .content {
    @apply flex flex-col gap-3;
  }

  blockquote {
    &.success, &.warning, &.danger, &.info, &.neutral, &.decorative {
      @apply rounded-md p-4 gap-2 border-l-[3px] text-primary flex flex-col pl-10 relative text-sm;

      &:not(.no-icon)::before {
        @apply text-base absolute left-4 w-4 h-4 content-[''] top-[18px];
        mask-size: cover;
        mask:url(/assets/icons/admonitions/info.svg);
      }
    }

    &.info {
      @apply bg-semantic-blue-secondary border-semantic-blue-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-blue-primary;
      }
    }

    &.success {
      @apply bg-semantic-green-secondary border-semantic-green-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-green-primary;
      }
    }

    &.warning {
      @apply bg-semantic-yellow-secondary border-semantic-yellow-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-yellow-primary;
        mask:url(/assets/icons/admonitions/warning.svg);
      }
    }

    &.danger {
      @apply bg-semantic-red-secondary border-semantic-red-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-red-primary;
        mask:url(/assets/icons/admonitions/danger.svg);
      }
    }

    &.neutral {
      @apply bg-semantic-grey-secondary border-semantic-grey-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-grey-primary;
      }
    }

    &.decorative {
      @apply bg-semantic-purple-secondary border-semantic-purple-primary;

      &:not(.no-icon)::before {
        @apply bg-semantic-purple-primary;
      }
    }
  }

  .mermaid svg {
    @apply m-auto;

    p, span {
      @apply text-primary !important;
    }

    rect, circle, ellipse, polygon {
      @apply fill-transparent stroke-[rgb(var(--color-brand))] !important;
    }

    .label-container {
      @apply fill-[rgb(var(--color-bg-secondary))] !important;
    }

    .edgeLabel {
      @apply bg-primary !important;

      p {
        @apply bg-secondary !important;
      }
    }

    path {
      @apply fill-[context-stroke] stroke-[rgb(var(--color-brand))] stroke-1 !important
    }
  }

  @-moz-document url-prefix() {
    .mermaid .flowchart-link {
      fill: none !important;
    }
  }

  .mermaid svg[aria-roledescription="sequence"] {
    .actor {
      @apply fill-[rgb(var(--color-bg-secondary))] !important;
    }

    .activation0 {
      @apply fill-[rgb(var(--color-bg-secondary))] !important;
    }

    text {
      @apply fill-[rgb(var(--color-text-primary))] !important;

    }

    text > tspan {
      @apply fill-[rgb(var(--color-text-primary))] !important;
    }

    .messageLine0 {
      @apply stroke-[rgb(var(--color-brand))] !important;
    }

    circle {
      @apply fill-[rgb(var(--color-bg-secondary))] !important;
    }
  }

  .badge {
    @apply rounded px-1.5 py-0.5 text-primary text-xs bg-brand-saturated/40;
  }

  .badge.deprecated {
    @apply bg-semantic-red-secondary;
  }

  .badge.premium-partner {
    @apply bg-semantic-purple-secondary;
  }

  .badge.third-party {
    @apply bg-semantic-green-secondary;
  }

  .badge.new-in {
    @apply align-middle;
  }

  .tablist {
    @apply list-none flex gap-4 text-sm ml-0 flex-row border-b border-primary/5 w-full items-center overflow-x-auto;
  }

  .tabcolumn {
    @apply list-none flex text-sm ml-0  w-full gap-0;

    ul, li {
      @apply list-none;
    }
  }

  .tab-button {
    @apply flex text-sm box-border;
  }

  .tab-button--active {
    @apply text-primary font-semibold border-brand !important;
  }

  .tab-button__horizontal {
    @apply tab-button py-3 text-terciary hover:no-underline items-center max-h-11 flex-shrink-0;

    &.tab-button__horizontal--active {
      @apply tab-button--active border-b-2 pb-[10px] !important;
    }
  }

  .tab-button__vertical {
    @apply tab-button py-2 px-5 text-terciary hover:no-underline border-l-2 border-transparent flex-wrap flex items-center gap-1;

    &.tab-button__vertical--active {
      @apply tab-button--active !important;
    }
  }

  .card {
    @apply flex rounded-md bg-secondary shadow-primary h-full;
  }

  .card__bordered {
    @apply border border-primary/5 hover:border hover:border-brand-saturated/40 hover:shadow-hover-card;
  }

  .card__featured {
    @apply border-brand-saturated/80 hover:border-brand-saturated border-2 relative overflow-hidden hover:shadow-hover-card;
  }

  .kong-conf-param h3 > a {
    @apply text-brand-saturated;
  }

  .kong-conf-param code {
    @apply text-sm;
  }

  #toc {
    @apply max-h-screen overflow-y-auto;
    counter-reset: toc-counter;
  }

  #toc .tab-button__vertical {
    @apply [overflow-wrap:anywhere];
  }

  #toc li > * {
    @apply mb-0;
  }

  #toc > li .how-to-step {
    @apply block;
    counter-increment: toc-counter;
  }

  #toc > li .how-to-step::before {
    @apply pr-1;
    content: counter(toc-counter) ".";
  }

  .background-gradient {
    background: linear-gradient(transparent, transparent) padding-box,
    linear-gradient(227.59deg, #E9EEF7 6.43%, #3CB087 30.81%, #11A06B 36.89%, #286FEB 65.64%, #E9EEF7 100%) border-box;
  }

  .filters {
    @apply w-full h-full md:sticky flex flex-col md:flex left-0 self-start md:top-24 md:self-start md:h-auto;
  }

  .mobile-drawer {
    @apply fixed inset-0 md:relative md:inset-auto flex items-end z-50;
  }

  .mobile-drawer__panel {
    @apply w-full bg-secondary md:bg-transparent transition-transform duration-300 transform h-[75vh] flex flex-col rounded-t-md md:translate-y-0;
  }

  .mobile-drawer__content {
    @apply flex flex-col flex-1 overflow-y-auto p-6 md:p-0 gap-8;
  }

  .mobile-drawer__footer {
    @apply flex w-full gap-3 p-6 bg-secondary border-t border-primary/5 md:hidden;
  }

  .filter-results-field {
    @apply relative;
  }

  .filter-results-field__image {
    @apply hidden md:flex absolute top-1/2 left-4 -translate-y-1/2;
  }

  .filter-results-field__input {
    @apply flex gap-2 bg-secondary rounded-md border border-brand-saturated/40 py-2 px-3 md:pl-11 items-center w-full;
  }

  .searchbox-results-container {
    @apply grid md:grid-cols-subgrid col-span-3 gap-16 md:grid-rows-[1rem_auto_auto];
  }

  .product-icon--background {
    @apply p-1.5 rounded-[2.22px];
  }

  .product-icon--bordered {
    @apply border-[0.28px] border-primary/[.08];
  }

  .how-to {
    counter-reset: steps-counter;
  }

  .how-to-step--title {
    counter-increment: steps-counter;
  }

  .how-to-step--title::before {
    @apply pr-2;
    content: counter(steps-counter) ".";
  }

  .top-nav {
    @apply absolute lg:static h-screen lg:h-full w-screen lg:w-full left-0 top-0 bg-secondary lg:bg-transparent flex flex-col lg:flex-row items-center lg:gap-8 transform translate-x-[-120%] lg:translate-x-0;
  }

  .top-nav__controls {
    @apply flex shrink-0 items-center bg-secondary w-full lg:hidden h-[64px] px-6 border-b border-primary/5 justify-between;
  }

  .top-nav--opened {
    @apply translate-x-0 transition-transform;

    .navbar-items {
      @apply overflow-y-auto;
    }

    .navbar-item__trigger_text {
      @apply  group-[.navbar-item--opened]:order-1;
    }

    .navbar-item__trigger_icon {
      @apply group-[.navbar-item--opened]:rotate-180;
    }

    .navbar-item__menu-caret {
      @apply group-[.navbar-item--opened]:block;
    }

    .navbar-item__trigger {
      @apply group-[.navbar-item--opened]:justify-start group-[.navbar-item--opened]:hidden;
    }

    .navbar-item--opened {
      @apply grid grid-cols-1 [grid-template-rows:1rem_auto] h-fit;

      .navbar-item__menu {
        @apply relative w-full top-auto left-auto max-w-full transform-none grid-cols-1 h-fit border-none gap-3 shadow-none;

        li {
          @apply py-2 lg:py-1;
        }
      }
    }
  }

  .navbar-items {
    @apply items-center ml-0 list-none flex flex-col flex-grow lg:flex-row gap-7 lg:gap-8 w-full p-6 lg:p-0;
  }

  .navbar-item {
    @apply relative w-full lg:w-fit;
  }

  .navbar-item--opened {
    .navbar-item__menu {
      @apply !grid;
    }

    .navbar-item__menu-caret {
      @apply !flex;
    }
  }

  .navbar-item__trigger {
    @apply flex gap-1 items-center !mb-0 cursor-pointer justify-between;
  }

  .navbar-item__trigger_text {
    @apply text-base lg:text-sm;
  }

  .navbar-item__trigger_icon {
    @apply flex h-3 w-3 items-center;

    > svg:first-of-type {
      @apply hidden lg:flex;
    }

    > svg:last-of-type {
      @apply flex lg:hidden;
    }
  }

  .navbar-item__menu-caret {
    @apply absolute left-1/2 transform -translate-x-1/2 -bottom-[11px] !mb-0 hidden;
  }

  .navbar-item__menu {
    @apply hidden absolute top-9 list-none ml-0 grid-cols-2 max-w-max w-svw gap-4 border rounded-lg lg:p-6 bg-secondary border-primary/5 shadow-primary left-1/2 -translate-x-1/2;
  }

  .navbar-item__icon {
    @apply inline-flex text-brand w-6 h-6 items-center justify-center !p-0;
  }
}

.ais-InstantSearch {
  @apply flex flex-col md:gap-8;
}

.ais-SearchBox {
  @apply w-full;
}

.ais-Pagination {
  @apply flex flex-col md:col-span-3 md:col-start-2 col-span-3 w-full gap-16;
}

.ais-Pagination-list {
  @apply flex-row justify-center gap-2;
}

.ais-Pagination-item {
  @apply bg-primary px-2 py-[6px] border border-primary/5 rounded-md w-[38px] h-[34px] flex items-center;
}

.ais-Pagination-item:hover {
  @apply bg-secondary;
}

.ais-Pagination-link {
  @apply h-5 w-full flex items-center justify-center text-primary;
}

.ais-Pagination-item--selected {
  @apply bg-secondary border-brand-saturated font-bold;
}

.ais-Pagination-link {
  @apply no-underline !important;
}

.ais-RefinementList-label {
  @apply flex gap-2 py-0.5 w-full text-sm text-primary items-center md:pl-1;
}

.ais-RefinementList-count {
  @apply hidden;
}

.ais-ClearRefinements-button {
  @apply !leading-[inherit];
}

.checkbox, .ais-RefinementList-checkbox {
  @apply form-checkbox bg-secondary rounded border border-primary/[.08] dark:border-primary/5;
}

.checkbox--checked, .ais-RefinementList-checkbox:checked {
  @apply bg-brand-saturated;
}

.ais-Panel--noRefinement {
  @apply hidden;
}

.ais-StateResults {
  @apply flex flex-col md:col-span-3 w-full gap-16;
}

.modal-overflow {
  @apply overflow-hidden overscroll-contain;
}

.card:target {
  @apply border-brand-saturated border-2;
}


/* Spec Renderer */
.call-button {
  @apply button button--secondary hover:!bg-transparent !border-brand;
}

.select-items-container {
  @apply rounded;
}

.select-item-container {
  .selected .select-item-label {
    @apply bg-brand/15 !important;
  }

  .select-item-label {
    @apply text-primary bg-secondary border-b border-primary/5 hover:bg-brand/15 !important;
  }
}

.select-popover.popover .popover-container {
  @apply border-none py-0 !important;
}