description: |
  Make requests to multiple APIs and combine their responses into one response.

extended_description: |
  Make requests to multiple APIs and combine their responses into one response.

  This example contains the following nodes:
  1. The node `FIRST_API` makes a `GET` request to the API at `https://example-api.com/fact`.
  2. The node `DOG_FACT` makes a `GET` request to the API at `https://second-example-api.com/facts`.
  3. The node `JOIN` combines the JSON response bodies of `FIRST_API` and `SECOND_APIT` into a single JSON object.
  4. The node `EXIT` sends a response to the client with the combined API response data. 
  This terminates the request instead of proxying it upstream.

title: Combine multiple API responses
weight: 900

config:
  nodes:
  - name: FIRST_API
    type: call
    url:  https://example-api.com/fact

  - name: SECOND_API
    type: call
    url:  https://second-example-api.com/facts

  - name: JOIN
    type: jq
    inputs:
      api1: FIRST_API.body
      api2: SECOND_API.body
    jq: |
      {
        api1_fact: .api1.data,
        api2_fact: .api1.data[0],
      }

  - name: EXIT
    type: exit
    inputs:
      body: JOIN
    status: 200

tools:
  - deck
  - admin-api
  - konnect-api
  - kic
  - terraform

min_version:
  gateway: '3.11'
