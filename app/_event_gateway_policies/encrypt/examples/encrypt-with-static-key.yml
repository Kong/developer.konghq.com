title: Encrypt using a static key

description: Encrypt portions of a message using a list of static keys.

extended_description: |
  Encrypt portions of a message using a list of static keys.

  The key must be a secret reference to a 128-bit (16-byte) base64-encoded string, or the key itself as a string.
  We recommend using secret references to avoid exposing sensitive data in your configuration.

weight: 900

requirements: 
 - "A corresponding [Decrypt policy](/event-gateway/policies/decrypt/examples/decrypt-with-static-key/). Event Gateway uses the key ID from the Encrypt policy along with the actual key in the Decrypt policy to successfully decrypt."
 
variables:
  key_id1:
    description: |
      A custom ID for a static key that will be used for encryption. 
      For example, you can define a key source named `my-key-id1`, and reference it as the `encrypt.key.id` for the part of the record you want to encrypt.
    value: $KEY_ID1
  key_id2:
    description: |
      Another custom ID for a static key that will be used for encryption. 
      For example, you can define a key source named `my-key-id2`, and reference it as the `encrypt.key.id` for the part of the record you want to encrypt.
    value: $KEY_ID2

type: encrypt
name: encrypt-static-key
config:
  failure_mode: error
  encrypt:
    - part_of_record: value
      key_id: ${key_id1}
    - part_of_record: key
      key_id: ${key_id2}
  key_sources:
    - type: static
      keys:
        - id: ${key_id1}
          key: ${env["MY_SECRET"]}
    - type: static
      keys:
        - id: ${key_id2}
          key: ${env["MY_SECRET"]}

tools:
  - konnect-api
